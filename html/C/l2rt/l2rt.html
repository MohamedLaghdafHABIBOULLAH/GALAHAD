<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C interfaces to GALAHAD L2RT: GALAHAD C package l2rt</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="galahad.small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">C interfaces to GALAHAD L2RT
   </div>
   <div id="projectbrief">header files for C interfaces to the GALAHAD L2RT package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GALAHAD C package l2rt </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="l2rt_intro"></a>
Introduction</h1>
<h2><a class="anchor" id="l2rt_purpose"></a>
Purpose</h2>
<p>Given a real \(m\) by \(n\) matrix \(A\), a real \(m\) vector \(b\) and scalars \(\sigma&gt;0\), \(\mu\geq 0\) and \(p \geq 2\), this package finds an <b> approximate minimizer of the regularised linear-least- \(\ell_2\)-norm objective function </p><p class="formulaDsp">
\[\sqrt{\| A x - b\|_2^2 + \mu \| x \|_2^2} + \frac{1}{p} \sigma \| x \|_2^p.\]
</p>
<p>  </b> This problem commonly occurs as a subproblem in nonlinear optimization calculations involving quadratic or cubic regularisation, and may be used to regularise the solution of under-determined or ill-conditioned linear least-squares problems. The method may be suitable for large \(m\) and/or \(n\) as no factorization involving \(A\) is required. Reverse communication is used to obtain matrix-vector products of the form \(u + A v\) and \(v + A^T u\).</p>
<h2><a class="anchor" id="l2rt_authors"></a>
Authors</h2>
<p>N. I. M. Gould, STFC-Rutherford Appleton Laboratory, England and M. Porcelli, Universita degli Studi di Firenze.</p>
<p>C interface, additionally J. Fowkes, STFC-Rutherford Appleton Laboratory.</p>
<h2><a class="anchor" id="l2rt_date"></a>
Originally released</h2>
<p>January 2008, C interface December 2021.</p>
<h2><a class="anchor" id="l2rt_terminology"></a>
Terminology</h2>
<p>The required solution \(x\) necessarily satisfies the optimality condition \(A^T ( A x - b ) + \lambda x = 0\), where the multiplier </p><p class="formulaDsp">
\[\lambda = \mu + \sigma \|x\|_2^{p-2} \sqrt{\| A x - b \|_2^2 + \mu \|x\|_2^2}.\]
</p>
 <h2><a class="anchor" id="l2rt_method"></a>
Method</h2>
<p>The method is iterative. Starting with the vector \(u_1 = b\), a bi-diagonalisation process is used to generate the vectors \(v_k\) and \(u_k+1\) so that the \(n\) by \(k\) matrix \(V_k = ( v_1 \ldots v_k)\) and the \(m\) by \((k+1)\) matrix \(U_k = ( u_1 \ldots u_{k+1})\) together satisfy </p><p class="formulaDsp">
\[A V_k = U_{k+1} B_k \;\mbox{and}\; b = \|b\|_2 U_{k+1} e_1\]
</p>
<p>  where \(B_k\) is \((k+1)\) by \(k\) and lower bi-diagonal, \(U_k\) and \(V_k\) have orthonormal columns and \(e_1\) is the first unit vector. The solution sought is of the form \(x_k = V_k y_k\), where \(y_k\) solves the bi-diagonal regularised least-squares problem </p><p class="formulaDsp">
\[(1) \;\;\; \min \| B_k y - \|b\| e_1 \|_2 + \frac{1}{p} \mu \| y \|_2^p.\]
</p>
 <p>To minimize (1), the optimality conditions </p><p class="formulaDsp">
\[( B_k^T ( B_k^{} y(\lambda) - \|b\| e_1^{} ) + \lambda y(\lambda) = 0,\]
</p>
<p>  where </p><p class="formulaDsp">
\[\lambda = \mu + \sigma \|y(\lambda)\|_2^{p-2} \sqrt{ \| B_k y(\lambda) - \|b\| e_1 \|_2^2 + \mu \|y(\lambda)\|_2^2},\]
</p>
<p>  are used as the basis of an iteration. The vector \(y(\lambda)\) is equivalently the solution to the regularised least-squares problem </p><p class="formulaDsp">
\[(2) \;\;\; \min \left \| \vect{ B_k \\ \lambda^{\frac{1}{2}} I } y- \|b\| e_1^{} \right \|_2.\]
</p>
<p>  Thus, given an estimate \(\lambda \geq 0\), (2) may be efficiently solved to give \(y(\lambda)\). It is then simply a matter of adjusting \(\lambda\) (for example by a Newton-like process) to solve the scalar nonlinear equation </p><p class="formulaDsp">
\[(3) \;\;\; \theta(\lambda) \equiv \sigma \|y(\lambda)\|_2^{p-2} \sqrt{ \| B_k y(\lambda) - \|b\| e_1 \|_2^2 + \mu \|y(\lambda)\|_2^2} + \mu - \lambda = 0.\]
</p>
<p>  In practice (3) is reformulated, and a more rapidly converging iteration is used. Having found \(y_k\), a second pass in which \(x_k = V_k y_k\) is regenerated is needed&mdash;this need only be done once \(x_k\) has implicitly deemed to be sufficiently close to optimality. As this second pass is an additional expense, a record is kept of the optimal objective function values for each value of \(k\), and the second pass is only performed so far as to ensure a given fraction of the final optimal objective value. Large savings may be made in the second pass by choosing the required fraction to be significantly smaller than one.</p>
<p>Special code is used in the special case \(p=2\), as in this case the equation (3) significantly simplifies.</p>
<h2><a class="anchor" id="l2rt_references"></a>
Reference</h2>
<p>A complete description of the un- and quadratically-regularised cases is given by</p>
<p>C. C. Paige and M. A. Saunders, LSQR: an algorithm for sparse linear equations and sparse least squares. ACM Transactions on Mathematical Software, 8(1):43&ndash;71, 1982</p>
<p>and</p>
<p>C. C. Paige and M. A. Saunders, ALGORITHM 583: LSQR: an algorithm for sparse linear equations and sparse least squares. ACM Transactions on Mathematical Software, 8(2):195&ndash;209, 1982.</p>
<p>Additional details on the Newton-like process needed to determine \(\lambda\) and other details are described in</p>
<p>C. Cartis, N. I. M. Gould and Ph. L. Toint, Trust-region and other regularisation of linear least-squares problems. BIT 49(1):21-53 (2009).</p>
<h2><a class="anchor" id="l2rt_call_order"></a>
Call order</h2>
<p>To solve a given problem, functions from the l2rt package must be called in the following order:</p>
<ul>
<li><a class="el" href="l2rt_8h.html#a0103448a3db662f9c483f9f44a5112bc">l2rt_initialize</a> - provide default control parameters and set up initial data structures</li>
<li><a class="el" href="l2rt_8h.html#a1b63f8b501208629cceb662b03f35684">l2rt_read_specfile</a> (optional) - override control values by reading replacement values from a file</li>
<li><a class="el" href="l2rt_8h.html#adf880b26c8aea32493857f8576e58ae8">l2rt_import_control</a> - import control parameters prior to solution</li>
<li><a class="el" href="l2rt_8h.html#a53042b19cef3a62c34631b00111ce754">l2rt_solve_problem</a> - solve the problem by reverse communication, a sequence of calls are made under control of a status parameter, each exit either asks the user to provide additional informaton and to re-enter, or reports that either the solution has been found or that an error has occurred</li>
<li><a class="el" href="l2rt_8h.html#a4fa18245556cf87b255b2b9ac5748ca9">l2rt_information</a> (optional) - recover information about the solution and solution process</li>
<li><a class="el" href="l2rt_8h.html#aa9b62de33c3d6c129cca1e90a3d548b7">l2rt_terminate</a> - deallocate data structures</li>
</ul>
<p>  
  See the <a href="examples.html">examples tab</a> for an illustration of use.
    </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
