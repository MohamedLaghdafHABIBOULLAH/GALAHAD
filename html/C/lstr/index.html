<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C interfaces to GALAHAD LSTR: GALAHAD C package lstr</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
   TeX: { Macros: {
    vect: ["{\\left(\\begin{array}{c}#1\\end{array}\\right)}",1],
    mat: ["{\\left(\\begin{array}{#1}#2\\end{array}\\right)}",2],
  } }
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">C interfaces to GALAHAD LSTR
   </div>
   <div id="projectbrief">header files for C interfaces to the GALAHAD LSTR package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GALAHAD C package lstr </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="lstr_intro"></a>
Introduction</h1>
<h2><a class="anchor" id="lstr_purpose"></a>
Purpose</h2>
<p>Given a real \(m\) by \(n\) matrix \(A\), a real \(m\) vector \(b\) and a scalar \(\Delta&gt;0\), this package finds an <b> approximate minimizer of \(\| A x - b\|_2\), where the vector \(x\) is required to satisfy the `&lsquo;trust-region&rsquo;' constraint \(\|x\|_2 \leq \Delta\).</b> This problem commonly occurs as a trust-region subproblem in nonlinear optimization calculations, and may be used to regularize the solution of under-determined or ill-conditioned linear least-squares problems. The method may be suitable for large \(m\) and/or \(n\) as no factorization involving \(A\) is required. Reverse communication is used to obtain matrix-vector products of the form \(u + A v\) and \(v + A^T u\).</p>
<h2><a class="anchor" id="lstr_authors"></a>
Authors</h2>
<p>N. I. M. Gould, STFC-Rutherford Appleton Laboratory, England.</p>
<p>C interface, additionally J. Fowkes, STFC-Rutherford Appleton Laboratory.</p>
<h2><a class="anchor" id="lstr_date"></a>
Originally released</h2>
<p>November 2007, C interface December 2021.</p>
<h2><a class="anchor" id="lstr_terminology"></a>
Terminology</h2>
<p>The required solution \(x\) necessarily satisfies the optimality condition \(A^T ( A x - b ) + \lambda x = 0\), where \(\lambda \geq 0\) is a Lagrange multiplier corresponding to the trust-region constraint \(\|x\|_2 \leq \Delta\).</p>
<h2><a class="anchor" id="lstr_method"></a>
Method</h2>
<p>The method is iterative. Starting with the vector \(u_1 = b\), a bi-diagonalisation process is used to generate the vectors \(v_k\) and \(u_k+1\) so that the \(n\) by \(k\) matrix \(V_k = ( v_1 \ldots v_k)\) and the \(m\) by \((k+1)\) matrix \(U_k = ( u_1 \ldots u_{k+1})\) together satisfy </p><p class="formulaDsp">
\[A V_k = U_{k+1} B_k \;\mbox{and}\; b = \|b\| U_{k+1} e_1,\]
</p>
<p>  where \(B_k\) is \((k+1)\) by \(k\) and lower bi-diagonal, \(U_k\) and \(V_k\) have orthonormal columns and \(e_1\) is the first unit vector. The solution sought is of the form \(x_k = V_k y_k\), where \(y_k\) solves the bi-diagonal least-squares trust-region problem </p><p class="formulaDsp">
\[(1) \;\;\; \min \| B_k y - \|b\| e_1 \|_2 \;\mbox{subject to}\; \|y\|_2 \leq \Delta.\]
</p>
 <p>If the trust-region constraint is inactive, the solution \(y_k\) may be found, albeit indirectly, via the LSQR algorithm of Paige and Saunders which solves the bi-diagonal least-squares problem </p><p class="formulaDsp">
\[ \min \| B_k y - \|b\| e_1 \|_2\]
</p>
<p>  using a QR factorization of \(B_k\). Only the most recent \(v_k\) and \(u_{k+1}\) are required, and their predecessors discarded, to compute \(x_k\) from \(x_{k-1}\). This method has the important property that the iterates \(y\) (and thus \(x_k\)) generated increase in norm with \(k\). Thus as soon as an LSQR iterate lies outside the trust-region, the required solution to (1) and thus to the original problem must lie on the boundary of the trust-region.</p>
<p>If the solution is so constrained, the simplest strategy is to interpolate the last interior iterate with the newly discovered exterior one to find the boundary point&mdash;the so-called Steihaug-Toint point&mdash;between them. Once the solution is known to lie on the trust-region boundary, further improvement may be made by solving </p><p class="formulaDsp">
\[ \min \| B_k y - \|b\| e_1 \|_2 \;\mbox{subject to}\; |\|y\|_2 = \Delta,\]
</p>
<p>  for which the optimality conditions require that \(y_k = y(\lambda_k)\) where \(\lambda_k\) is the positive root of </p><p class="formulaDsp">
\[B_k^T ( B_k^{} y(\lambda) - \|b\| e_1^{} ) + \lambda y(\lambda) = 0 \;\mbox{and}\; \|y(\lambda)\|_2 = \Delta\]
</p>
<p>  The vector \(y(\lambda)\) is equivalently the solution to the regularized least-squares problem </p><p class="formulaDsp">
\[\min \left \| \vect{ B_k \\ \lambda^{\frac{1}{2}} I } y - \|b\| e_1^{} \right \|\]
</p>
<p>  and may be found efficiently. Given \(y(\lambda)\), Newton's method is then used to find \(\lambda_k\) as the positive root of \(\|y(\lambda)\|_2 = \Delta\). Unfortunately, unlike when the solution lies in the interior of the trust-region, it is not known how to recur \(x_k\) from \(x_{k-1}\) given \(y_k\), and a second pass in which \(x_k = V_k y_k\) is regenerated is needed&mdash;this need only be done once \(x_k\) has implicitly deemed to be sufficiently close to optimality. As this second pass is an additional expense, a record is kept of the optimal objective function values for each value of \(k\), and the second pass is only performed so far as to ensure a given fraction of the final optimal objective value. Large savings may be made in the second pass by choosing the required fraction to be significantly smaller than one.</p>
<h2><a class="anchor" id="lstr_references"></a>
Reference</h2>
<p>A complete description of the unconstrained case is given by</p>
<p>C. C. Paige and M. A. Saunders, LSQR: an algorithm for sparse linear equations and sparse least squares. ACM Transactions on Mathematical Software, 8(1):43&ndash;71, 1982</p>
<p>and</p>
<p>C. C. Paige and M. A. Saunders, ALGORITHM 583: LSQR: an algorithm for sparse linear equations and sparse least squares. ACM Transactions on Mathematical Software, 8(2):195&ndash;209, 1982.</p>
<p>Additional details on how to proceed once the trust-region constraint is encountered are described in detail in</p>
<p>C. Cartis, N. I. M. Gould and Ph. L. Toint, Trust-region and other regularisation of linear least-squares problems. BIT 49(1):21-53 (2009).</p>
<h2><a class="anchor" id="lstr_call_order"></a>
Call order</h2>
<p>To solve a given problem, functions from the lstr package must be called in the following order:</p>
<ul>
<li><a class="el" href="lstr_8h.html#ae423bf7ffc77c89f461448ca1f5c286c">lstr_initialize</a> - provide default control parameters and set up initial data structures</li>
<li><a class="el" href="lstr_8h.html#a3d3fa989fe4c3b40cd7e296249d2205d">lstr_read_specfile</a> (optional) - override control values by reading replacement values from a file</li>
<li><a class="el" href="lstr_8h.html#a1a8ad63d944dc046fd2040554d6d01e5">lstr_import_control</a> - import control parameters prior to solution</li>
<li><a class="el" href="lstr_8h.html#af3355e5a8df63a9c7173eb974a1e7562">lstr_solve_problem</a> - solve the problem by reverse communication, a sequence of calls are made under control of a status parameter, each exit either asks the user to provide additional informaton and to re-enter, or reports that either the solution has been found or that an error has occurred</li>
<li><a class="el" href="lstr_8h.html#a5929f00ea00af253ede33a6749451481">lstr_information</a> (optional) - recover information about the solution and solution process</li>
<li><a class="el" href="lstr_8h.html#aa198189942e179e52699e1fedfcdf9d1">lstr_terminate</a> - deallocate data structures</li>
</ul>
<p>  
  See the <a href="examples.html">examples tab</a> for an illustration of use.
    </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
