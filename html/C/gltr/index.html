<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C interfaces to GALAHAD GLTR: GALAHAD C package gltr</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="galahad.small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">C interfaces to GALAHAD GLTR
   </div>
   <div id="projectbrief">header files for C interfaces to the GALAHAD GLTR package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GALAHAD C package gltr </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="gltr_intro"></a>
Introduction</h1>
<h2><a class="anchor" id="gltr_purpose"></a>
Purpose</h2>
<p>Given real \(n\) by \(n\) symmetric matrices \(H\) and \(M\) (with \(M\) positive definite), a real \(n\) vector \(c\) and scalars \(\Delta&gt;0\) and \(f_0\), this package finds an <b> approximate minimizer of the quadratic objective function \(\frac{1}{2} x^T H x + c^T x + f_0\), where the vector \(x\) is required to satisfy the constraint \(\|x\|_M \leq \Delta\)</b>, and where the \(M\)-norm of \(x\) is \(\|x\|_M = \sqrt{x^T M x}\). This problem commonly occurs as a trust-region subproblem in nonlinear optimization calculations. The method may be suitable for large \(n\) as no factorization of \(H\) is required. Reverse communication is used to obtain matrix-vector products of the form \(H z\) and \(M^{-1} z\).</p>
<p>The package may also be used to solve the related problem in which \(x\) is instead required to satisfy the <b>equality constraint \(\|x\|_M = \Delta\)</b>.</p>
<h2><a class="anchor" id="gltr_authors"></a>
Authors</h2>
<p>N. I. M. Gould, STFC-Rutherford Appleton Laboratory, England.</p>
<p>C interface, additionally J. Fowkes, STFC-Rutherford Appleton Laboratory.</p>
<h2><a class="anchor" id="gltr_date"></a>
Originally released</h2>
<p>April 1997, C interface December 2021.</p>
<h2><a class="anchor" id="gltr_terminology"></a>
Terminology</h2>
<h2><a class="anchor" id="gltr_method"></a>
Method</h2>
<p>The required solution \(x\) necessarily satisfies the optimality condition \(H x + \lambda M x + c = 0\), where \(\lambda \geq 0\) is a Lagrange multiplier corresponding to the constraint \(\|x\|_M \leq \Delta\). In addition, the matrix \(H + \lambda M\) will be positive definite.</p>
<p>The method is iterative. Starting with the vector \(M^{-1} c\), a matrix of Lanczos vectors is built one column at a time so that the \(k\)-th column is generated during iteration \(k\). These columns span a so-called Krylov space. The resulting \(n\) by \(k\) matrix \(Q_k \) has the property that \(Q_k^T H Q_k^{} = T_k^{}\), where \(T_k\) is tridiagonal. An approximation to the required solution may then be expressed formally as </p><p class="formulaDsp">
\[x_{k+1} = Q_k y_k,\]
</p>
<p>  where \(y_k \) solves the `&lsquo;tridiagonal&rsquo;' subproblem of minimizing </p><p class="formulaDsp">
\[(1) \;\;\; \frac{1}{2} y^T T_k y + \|c\|_{M^{-1}} e_1^T y\;\mbox{subject to the constraint}\; \|y\|_2 \leq \Delta,\]
</p>
<p>  and where \(e_1\) is the first unit vector.</p>
<p>If the solution to (1) lies interior to the constraint, the required solution \(x_{k+1}\) may simply be found as the \(k\)-th (preconditioned) conjugate-gradient iterate. This solution can be obtained without the need to access the whole matrix \(Q_k\). These conjugate-gradient iterates increase in \(M\)-norm, and thus once one of them exceeds \(\Delta\) in \(M\)-norm, the solution must occur on the constraint boundary. Thereafter, the solution to (1) is less easy to obtain, but an efficient inner iteration to solve (1) is nonetheless achievable because \(T_k \) is tridiagonal. It is possible to observe the optimality measure \(\|H x + \lambda M x + c\|_{M^{-1}}\) without computing \(x_{k+1}\), and thus without needing \(Q_k \). Once this measure is sufficiently small, a second pass is required to obtain the estimate \(x_{k+1} \) from \(y_k \). As this second pass is an additional expense, a record is kept of the optimal objective function values for each value of \(k\), and the second pass is only performed so far as to ensure a given fraction of the final optimal objective value. Large savings may be made in the second pass by choosing the required fraction to be significantly smaller than one.</p>
<p>A cheaper alternative is to use the Steihuag-Toint strategy, which is simply to stop at the first boundary point encountered along the piecewise linear path generated by the conjugate-gradient iterates. Note that if \(H\) is significantly indefinite, this strategy often produces a far from optimal point, but is effective when \(H\) is positive definite or almost</p>
<h2><a class="anchor" id="gltr_references"></a>
Reference</h2>
<p>The method is described in detail in</p>
<p>N. I. M. Gould, S. Lucidi, M. Roma and Ph. L. Toint, Solving the trust-region subproblem using the Lanczos method. SIAM Journal on Optimization <b>9:2</b> (1999), 504-525.</p>
<h2><a class="anchor" id="gltr_call_order"></a>
Call order</h2>
<p>To solve a given problem, functions from the gltr package must be called in the following order:</p>
<ul>
<li><a class="el" href="gltr_8h.html#ac06a7060d9355146e801157c2f29ca5c">gltr_initialize</a> - provide default control parameters and set up initial data structures</li>
<li><a class="el" href="gltr_8h.html#a68a3273a88b27601e72b61f10a23de31">gltr_read_specfile</a> (optional) - override control values by reading replacement values from a file</li>
<li><a class="el" href="gltr_8h.html#acb8a654fc381e3f231c3d10858f111b3">gltr_import_control</a> - import control parameters prior to solution</li>
<li><a class="el" href="gltr_8h.html#ad77040d245e6bc307d13ea0cec355f18">gltr_solve_problem</a> - solve the problem by reverse communication, a sequence of calls are made under control of a status parameter, each exit either asks the user to provide additional informaton and to re-enter, or reports that either the solution has been found or that an error has occurred</li>
<li><a class="el" href="gltr_8h.html#a1b1b4d87884833c4bfe184ff79c1e2bb">gltr_information</a> (optional) - recover information about the solution and solution process</li>
<li><a class="el" href="gltr_8h.html#ac3e0cbd0ecc79b37251fad7fd6f47631">gltr_terminate</a> - deallocate data structures</li>
</ul>
<p>  
  See the <a href="examples.html">examples tab</a> for an illustration of use.
    </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
